<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
    
</head>
<body>
    <p id="mytoken"></p>
    <form  name="formulario">
        Login:
        <input type="text" value="" name="login" /> <br> <br>
        Name:
        <input type="text" value="" name="name" /> <br> <br>
        Email:
        <input type="text" value="" name="email" /> <br> <br>
        Password:
        <input type="text" value="" name="password" /> <br> <br>
        Confirma_Password:
        <input type="text" value="" name="confirma_password" /> <br> <br>
        IdEmpresa:
        <input type="text" value="" name="IdEmpresa" /> <br> <br>
        Status:
        <input type="text" value="" name="Status" /> <br> <br>
        Role:
        <input type="text" value="" name="role" /> <br> <br>
        regId:
        <input type="text" value="" name="regId" /> <br> <br>
        status:
        <input type="text" value="" name="status" /> <br> <br>
        <button onclick="envio(event)">Enviar Formulario</button>
    </form>
        
        <script>
            const t = localStorage.getItem("token");
            if(t){
                document.getElementById("mytoken").innerHTML = t;
            }
            const envio = (e) => {
                e.preventDefault();
                var login = document.forms["formulario"]["login"];
                var name = document.forms["formulario"]["name"];
                var email = document.forms["formulario"]["email"];
                var password = document.forms["formulario"]["password"];
                var confirma_password = document.forms["formulario"]["confirma_password"];
                var IdEmpresa = document.forms["formulario"]["IdEmpresa"];
                var Status = document.forms["formulario"]["Status"];
                var role = document.forms["formulario"]["role"];
                var regId = document.forms["formulario"]["regId"];
                var status = document.forms["formulario"]["status"];
                var request = new XMLHttpRequest();
                request.open("POST","http://52.91.139.190/fsapi/users/auth/register-jwt");
                request.setRequestHeader("Content-type","application/json");
                request.onreadystatechange = () => {
                    if(request.readyState == 4 && request.status == 200){
                        const obj = JSON.parse(request.responseText);
                        if(obj.token != null){
                            console.log(obj.token);
                            localStorage.setItem("token",obj.token);
                            document.getElementById("mytoken").innerHTML = obj.token;
                        }
                        
                    }
                };

                const body = JSON.stringify({
                    "login": login.value,
                    "name": name.value,
                    "email": email.value,
                    "password": password.value,
                    "confirma_password": confirma_password.value,
                    "IdEmpresa": IdEmpresa.value,
                    "Status": Status.value,
                    "role": role.value,
                    "regId": regId.value,
                    "status": status.value

                })

                request.send(body);
                console.log("body:",body);
            }
        </script>
</body>
</html>